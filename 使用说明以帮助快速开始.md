# MementoDB 快速开始指南

## 一键启动

**在任何 Linux 系统上，只需运行：**

```bash
./start.sh
```

脚本会自动：
1. ✅ 检测系统类型（Ubuntu/Debian/CentOS/Arch等）
2. ✅ 检查必需的依赖（CMake、编译器）
3. ✅ 提供缺失依赖的安装命令
4. ✅ 自动构建项目
5. ✅ 启动数据库服务器

## 系统要求

### 必需依赖

- **CMake** 3.16 或更高版本
- **C++ 编译器** (g++ 或 clang++)
- **make** (通常随编译器一起安装)

### 可选依赖

- **Conan** (用于依赖管理，可选)

## 自动安装依赖

如果缺少依赖，脚本会显示安装命令。根据你的系统类型：

### Ubuntu/Debian
```bash
sudo apt-get update
sudo apt-get install -y cmake build-essential
```

### CentOS/RHEL/Fedora
```bash
sudo dnf install -y cmake gcc-c++ make
# 或使用 yum (旧版本)
sudo yum install -y cmake gcc-c++ make
```

### Arch Linux
```bash
sudo pacman -S --noconfirm cmake base-devel
```

### 安装 Conan (可选)
```bash
pip3 install conan
```

## 使用示例

### 1. 首次启动（自动构建）
```bash
./start.sh
```

### 2. 前台运行（查看实时日志）
```bash
./start.sh --foreground
```

### 3. 只构建，不启动
```bash
./start.sh --build-only
```

### 4. 直接启动（跳过构建）
```bash
./start.sh --no-build
```

## 连接数据库

服务器启动后，监听在 `127.0.0.1:6380`

### 使用 redis-cli
```bash
redis-cli -p 6380
```

### 使用 telnet
```bash
telnet 127.0.0.1 6380
```

### 基本操作
```bash
127.0.0.1:6380> SET mykey "Hello"
OK
127.0.0.1:6380> GET mykey
"Hello"
127.0.0.1:6380> EXISTS mykey
(integer) 1
127.0.0.1:6380> DEL mykey
(integer) 1
```

## 停止服务器

```bash
./stop.sh
```

或如果在前台运行，按 `Ctrl+C`

## 查看日志

```bash
tail -f logs/server.log
```

## 故障排查

### 问题：缺少依赖

**症状：** 脚本提示缺少 CMake 或编译器

**解决：** 按照脚本显示的安装命令安装依赖

### 问题：CMake 配置失败

**可能原因：**
- CMake 版本过低（需要 3.16+）
- 编译器未正确安装
- 依赖库缺失

**解决：**
1. 检查 CMake 版本：`cmake --version`
2. 检查编译器：`g++ --version` 或 `clang++ --version`
3. 查看详细错误信息

### 问题：编译失败

**可能原因：**
- 源代码错误
- 依赖不完整
- 内存不足

**解决：**
1. 查看编译输出的错误信息
2. 确保所有依赖已安装
3. 尝试清理后重新构建：`rm -rf build && ./start.sh`

### 问题：端口被占用

**症状：** 启动失败，提示端口 6380 被占用

**解决：**
1. 检查端口占用：`netstat -tuln | grep 6380`
2. 停止占用端口的进程
3. 或修改 `src/main.cpp` 中的端口号

### 问题：服务器启动后立即退出

**解决：**
1. 查看日志：`tail -n 50 logs/server.log`
2. 检查数据目录权限
3. 尝试前台运行查看详细错误：`./start.sh --foreground`

## 常见问题

### Q: 脚本支持哪些 Linux 发行版？

A: 支持 Ubuntu、Debian、CentOS、RHEL、Fedora、Arch Linux、openSUSE 等主流发行版。

### Q: 需要 root 权限吗？

A: 安装依赖时需要 sudo 权限，运行数据库服务器不需要 root 权限。

### Q: 可以在 Windows 上运行吗？

A: 当前脚本仅支持 Linux。Windows 用户可以使用 WSL 或手动使用 CMake 构建。

### Q: 如何修改端口？

A: 编辑 `src/main.cpp`，修改 `lc.port = 6380;` 为其他端口。

### Q: 数据存储在哪里？

A: 数据存储在 `./data/` 目录，日志在 `./logs/server.log`。

## 下一步

- 查看 `USAGE_GUIDE.md` 了解详细使用说明
- 查看 `使用说明.md` 了解完整功能
- 查看 `Readme.md` 了解架构设计
